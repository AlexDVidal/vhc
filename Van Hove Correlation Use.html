<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308626 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8464"/>

<div>
<span><div><div><div><span style="font-size: 13pt; font-family: &quot;Courier New&quot;;">vhc.m is a script which finds the Van Hove correlation of a given vector by finding the difference in measurements at different time lags (or intervals) and then finding the normalized distribution of each of these time lags. Both time lag and distribution limits are configurable. The script has the following interface:</span></div><div><span style="font-size: 13pt;"><br/></span></div><div style="min-height: 13pt; text-align: left;"><span style="min-height: 13pt; font-size: 13pt; color: rgb(0, 0, 255); font-family: &quot;Courier New&quot;;">function</span> <span style="min-height: 13pt; font-size: 13pt; font-family: &quot;Courier New&quot;;">[lagData, timeLags, counts, edges] =</span> <span style="min-height: 13pt; font-size: 13pt; color: rgb(0, 0, 255); font-family: &quot;Courier New&quot;;">...</span></div><div style="min-height: 13pt; text-align: left;"><span style="min-height: 13pt; font-size: 13pt; font-family: &quot;Courier New&quot;;">    vhc(data, fs, dT, preview, edgeMin, edgeMax, binCount)</span></div><div><br/></div><div><span style="min-height: 13pt;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">NOTE: vhc by its nature generates large matrices when finding time lags. Matlab may balk if vhc tries to reserve too much memory, therefore if you are working with large data sets consider reducing the scope of samples analyzed, the scope of time lags analyzed, or reduce the resolution of dT</span><span style="font-size: 14pt; font-family: &quot;Courier New&quot;;">.</span></span></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="min-height: 13pt;"><span style="font-size: 14pt; font-family: &quot;Courier New&quot;;">Returned Values:</span></span></div><ul><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">lagData</span> is a matrix of the differences in the data at each time lag. Each row vector corresponds to one time lag where each element is given by data(i) - data(i+lag)</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">timeLags</span> is a vector showing each time lag used in calculating each row of lagData. Any time lags passed in as arguments may be rounded to the nearest sample time or eliminated if not in scope of the data set, timeLags gives the actual times used in calculating lagData.</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">counts</span> is a matrix where each row is the normalized distribution of a given time lag.</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">edges</span> is a vector showing the value of the edges of the bins used in calculating the distributions in counts.</span></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 14pt; font-family: &quot;Courier New&quot;;">Mandatory Arguments:</span></div><ul><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">data</span> a vector containing the raw data you want to calculate the vhc for.</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">fs</span> the sampling frequency of the data set in Hertz.</span></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 14pt; font-family: &quot;Courier New&quot;;">Optional Arguments:</span></div><ul><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">dT</span> a vector of all the time lags to be used in calculating timeLags, in seconds. Any values &lt;=0 or &gt;= the length of all data are ignored. If a given value does not align exactly with a sample time then vhc will round to the nearest sample. All final time lag values are returned in timeLags. </span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">preview</span> a boolean indicating whether to show a surface plot of the calculated distributions. Default is false.</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">edgeMin</span> value of the lower edge of the first bin in calculating distributions. Default is mean(lagData)-4*std(lagData).</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">edgeMax</span> value of the higher edge of the last bin in calculating distributions. Default is mean(lagData)+4*std(lagData).</span></div></li><li><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><span style="font-size: 12pt; font-family: &quot;Courier New&quot;; font-weight: bold;">binCount</span> determines the number of bins to use in calculating distributions. Default is 50.</span></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Usage examples:</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Find the vhc of the first 10k samples of some chlamy force measurements using default settings</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; r = load('MachineLearning\ActivePassive\rawData.mat');</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; </span><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">data = r.raw(:,1);</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; fs = 50000;</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; [tl td counts edges] = vhc(data(1:10000), fs);</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Calculating time lag data: Done</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Calculating distributions: Done</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; surf(counts)</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; shading interp</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><img src="Van Hove Correlation Use_files/Image.png" type="image/png" data-filename="Image.png" width="481"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Find the vhc of an entire chlamy force data set, but only calculate time lags from .01 to 2 seconds in .01 second intervals. Increase bin count to 100 and preview the distribution, do not set bin edges.</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; r = load('MachineLearning\ActivePassive\rawData.mat');</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; fs = 50000;</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; </span><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">data = r.raw(:,1);</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; [tl td counts edges] = vhc(data, fs, .01, 2, .01, true, [], [], 100);</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Calculating time lag data: Done</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Calculating distributions: Done</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><img src="Van Hove Correlation Use_files/Image [1].png" type="image/png" data-filename="Image.png" width="504"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Find vhc using above parameters, but only calculate the distribution of values from 0 to 20</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">&gt;&gt; [tl td counts edges] = vhc(data, fs, .01, 2, .01, true, 0.0, 20, 100);</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Calculating time lag data: Done</span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;">Calculating distributions: Done</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: &quot;Courier New&quot;;"><img src="Van Hove Correlation Use_files/Image [2].png" type="image/png" data-filename="Image.png" width="548"/></span></div><div><br/></div><div><a href="Van Hove Correlation Use_files/vhc.m"><img src="Van Hove Correlation Use_files/d5c679217a8d85f5a8917f1bbf572b7c.png" alt="vhc.m"></a></div><div><br/></div></div><div><br/></div><div><span style="font-size: 14pt;">Changes/bug fixes</span></div><ul><li><div><span style="font-size: 14pt;">changed time lags to be in units of seconds instead of samples, extra control on distributions, can visually preview the distributions</span></div></li><li><div><span style="font-size: 14pt;">fixed bug that calculated large time lags incorrectly, made previews more informative</span></div></li><li><div><span style="font-size: 14pt;">mean and std use new syntax in R2019a (?), calculate mean and std manually now</span></div></li><li><div><span style="font-size: 14pt;">the 'probability' option in histcounts calculates a bin value as counts in that bin over total number of elements. at greater time lags more and more of the elements were nans, deflating probabilities</span></div></li></ul><div><br/></div></div><div><br/></div></span>
</div></body></html> 